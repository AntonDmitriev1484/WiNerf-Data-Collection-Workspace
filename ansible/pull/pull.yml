---
- name: Download one or more files or directories from remote to local
  hosts: DataNUCs
  vars:
    file_paths: []     # e.g., ["collect/ros1/file1.bag", "collect/ros1/dir1"]
    dir: false   # set to true if pulling directories
    remote_root: "/home/admi3ev/WiNerf-Data-Collection-Workspace/"
    local_root: "/home/antond2/Desktop/Research/WiNerf-Data-Collection-Workspace/"

    # Example use:
    # ansible-playbook pull.yml \
    # -e 'file_paths=["collect/ros1/dir1","collect/ros1/dir2"]' \
    # -e 'dir=true' # <- just leave this option off if you're not pulling a directory


  tasks:
    - name: Download files using fetch (non-recursive)
      when: not dir
      fetch:
        src: "{{ remote_root }}{{ item }}"
        dest: "{{ local_root }}{{ item }}"
        flat: yes
      loop: "{{ file_paths }}"

    - name: Download directories using synchronize (recursive)
      when: dir
      synchronize:
        src: "{{ remote_root }}{{ item }}/"
        dest: "{{ local_root }}{{ item }}"
        mode: pull
        recursive: yes
      loop: "{{ file_paths }}"
